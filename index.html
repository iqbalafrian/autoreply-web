<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AutoReply Editor</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 16px;
      background-color: #fff;
      font-size: 14px;
    }
    input, textarea, button {
      width: 100%;
      margin-bottom: 10px;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .template-item {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      margin-bottom: 8px;
    }
    .template-item div {
      flex: 1;
    }
    .template-list {
      max-height: 200px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <h2><b>AutoReply</b></h2>

  <input id="title" type="text" placeholder="Judul Template" />
  <textarea id="content" placeholder="Isi Template" rows="3"></textarea>
  <button onclick="saveTemplate()">Simpan</button>

  <div id="templateContainer"></div>

  <script>
    const titleInput = document.getElementById("title");
    const contentInput = document.getElementById("content");
    const container = document.getElementById("templateContainer");

    let templates = JSON.parse(localStorage.getItem("templates")) || [];
    let selected = [];

    function renderTemplates() {
      container.innerHTML = "";
      if (templates.length === 0) return;

      const selectAllBox = document.createElement("div");
      selectAllBox.innerHTML = `
        <label><input type="checkbox" onchange="toggleSelectAll(this)"> Pilih Semua</label>
        <div class="template-list" id="list"></div>
        <button onclick="deleteSelected()">Hapus Dipilih</button>
      `;
      container.appendChild(selectAllBox);

      const list = document.getElementById("list");
      templates.forEach((tpl, i) => {
        const item = document.createElement("label");
        item.className = "template-item";
        item.innerHTML = `
          <input type="checkbox" onchange="toggle(${i})" ${selected.includes(i) ? "checked" : ""}/>
          <div>
            <div><b>${tpl.title}</b></div>
            <div style="font-size: 12px; color: gray">${tpl.content.length > 60 ? tpl.content.substring(0, 60) + "..." : tpl.content}</div>
          </div>
        `;
        list.appendChild(item);
      });
    }

    function saveTemplate() {
      const title = titleInput.value.trim();
      const content = contentInput.value.trim();
      if (!title || !content) {
        alert("Judul dan isi template tidak boleh kosong!");
        return;
      }
      templates.push({ title, content });
      localStorage.setItem("templates", JSON.stringify(templates));
      titleInput.value = "";
      contentInput.value = "";
      renderTemplates();
    }

    function toggle(index) {
      if (selected.includes(index)) {
        selected = selected.filter(i => i !== index);
      } else {
        selected.push(index);
      }
    }

    function toggleSelectAll(el) {
      selected = el.checked ? templates.map((_, i) => i) : [];
      renderTemplates();
    }

    function deleteSelected() {
      templates = templates.filter((_, i) => !selected.includes(i));
      localStorage.setItem("templates", JSON.stringify(templates));
      selected = [];
      renderTemplates();
    }

    renderTemplates();
  </script>
</body>
</html>
